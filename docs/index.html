<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>GameHubRoulette</title>

<style>
:root{
--bg:#0b0c10;
--panel:#12141b;
--text:#e6e6e6;
--muted:#9aa3c7;
--border:#232842;
--accent:#6ea8ff;
--accent2:#8a5cff;
font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
}

*{box-sizing:border-box}
body{
margin:0;
background:radial-gradient(1200px 700px at 20% 0%, #101528 0%, var(--bg) 60%);
color:var(--text);
}

.wrap{max-width:980px;margin:0 auto;padding:28px 16px 60px;}

h1{margin:0;font-size:32px;}
h2{margin:0 0 10px;font-size:18px;}
p{color:var(--muted);line-height:1.6;}

.card{
background:rgba(18,20,27,.8);
border:1px solid var(--border);
border-radius:18px;
padding:18px;
margin-top:18px;
box-shadow:0 20px 60px rgba(0,0,0,.25);
}

.row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;}

button,input{
border-radius:14px;
border:1px solid var(--border);
background:#0f1117;
color:var(--text);
padding:12px 14px;
font-size:14px;
}

button{
cursor:pointer;
background:linear-gradient(135deg, rgba(110,168,255,.25), rgba(138,92,255,.25));
border-color:rgba(110,168,255,.4);
}

button:hover{opacity:.9}
button:disabled{opacity:.5;cursor:not-allowed}

input{width:220px}

.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}

.status{
margin-top:14px;
padding:12px;
border-radius:14px;
border:1px solid var(--border);
background:#0f1117;
color:var(--muted);
white-space:pre-wrap;
}

.footer{
margin-top:40px;
font-size:12px;
color:var(--muted);
border-top:1px solid var(--border);
padding-top:16px;
}

@media(max-width:860px){
input{width:100%}
}
</style>
</head>

<body>
<div class="wrap">

<h1>ðŸŽ® GameHubRoulette</h1>
<p>On-chain roulette (gas only) + game action logging + prize distribution.</p>

<div class="card">
<h2>ðŸ”— Connection</h2>

<div class="row">
<button id="btnConnect">Connect Wallet</button>
<span class="mono" id="wallet">disconnected</span>
</div>

<div class="row">
<span>Network:</span>
<span class="mono" id="network">-</span>
</div>

<div class="row">
<span>Contract:</span>
<span class="mono" id="contractShort">-</span>
</div>
</div>

<div class="card">
<h2>ðŸŽ² Spin Roulette</h2>

<div class="row">
<input id="gameId" value="GAME1"/>
<input id="maxInt" value="10"/>
<button id="btnSpin" disabled>Spin</button>
</div>

<div class="status" id="status"></div>
</div>

<div class="footer">
MIT License â€¢ Randomness is weak and not suitable for real-money betting.
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/ethers@6.13.4/dist/ethers.umd.min.js"></script>
<script>

// ==============================
// ðŸ”¥ EDIT ONLY THIS SECTION
// ==============================
const CONTRACT_ADDRESS = "COLE_AQUI_SEU_ENDERECO";
const TARGET_CHAIN_ID = 8453; // 8453 Base | 84532 Base Sepolia
// ==============================

const ABI = [
"function spinRoulette(string gameId,uint256 maxInt) external returns(uint256)",
"event RouletteSpin(address indexed player,string gameId,uint256 result,uint256 maxInt,uint256 timestamp)"
];

const $ = id => document.getElementById(id);

$("contractShort").textContent =
CONTRACT_ADDRESS !== "COLE_AQUI_SEU_ENDERECO"
? CONTRACT_ADDRESS.slice(0,6)+"..."+CONTRACT_ADDRESS.slice(-4)
: "-";

let provider, signer, contract;

async function connect(){
if(!window.ethereum){
alert("Install MetaMask");
return;
}

provider = new ethers.BrowserProvider(window.ethereum);
await provider.send("eth_requestAccounts",[]);
signer = await provider.getSigner();

const network = await provider.getNetwork();
$("network").textContent = network.chainId.toString();

if(Number(network.chainId) !== TARGET_CHAIN_ID){
alert("Wrong network selected in MetaMask");
}

contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);

const addr = await signer.getAddress();
$("wallet").textContent = addr.slice(0,6)+"..."+addr.slice(-4);
$("btnSpin").disabled = false;
}

async function spin(){
try{
$("status").textContent="Sending transaction...";

const gameId = $("gameId").value;
const maxInt = BigInt($("maxInt").value);

const tx = await contract.spinRoulette(gameId, maxInt);
$("status").textContent="Waiting confirmation...\n"+tx.hash;

const receipt = await tx.wait();

let resultFound = false;

for(const log of receipt.logs){
try{
const parsed = contract.interface.parseLog(log);
if(parsed.name==="RouletteSpin"){
$("status").textContent=
"Result: "+parsed.args.result.toString();
resultFound=true;
}
}catch{}
}

if(!resultFound){
$("status").textContent="Transaction confirmed.";
}

}catch(err){
$("status").textContent="Error: "+err.message;
}
}

$("btnConnect").onclick=connect;
$("btnSpin").onclick=spin;

</script>
</body>
</html>
